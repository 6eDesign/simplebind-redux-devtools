{"version":3,"file":"simplebind-redux-devtools.umd.js","sources":["../index.js"],"sourcesContent":["import simpleBind from 'simplebind.js';\r\n\r\nlet { bind, registerPlugin, util } = simpleBind;\r\nlet state = simpleBind.getState();\r\n\r\nconst useDevTools = typeof window.__REDUX_DEVTOOLS_EXTENSION__ != 'undefined'; \r\nlet devTools, isBindDueToDevTools = false;\r\nif(useDevTools) { \r\n  devTools = window.__REDUX_DEVTOOLS_EXTENSION__.connect({latency: 0});\r\n  devTools.subscribe((message,...args) => {\r\n    console.log(`redux devtools message ${JSON.stringify(message,null,2)}`)\r\n    if (message.type === 'DISPATCH' && message.state) {\r\n      let newState = JSON.parse(message.state); \r\n      for(var key in newState) {\r\n        isBindDueToDevTools = true;\r\n        bind(key,newState[key]);\r\n      }\r\n    }\r\n  });\r\n}\r\n\r\nlet isARepeatKey = name => name.indexOf('__repeat') == 0;\r\n\r\nlet removeRepeatsFromState = obj => { \r\n  let newObj = Object.keys(obj).reduce((newObj,key) => { \r\n    if(!isARepeatKey(key)) newObj[key] = obj[key]; \r\n    return newObj;\r\n  },{}); \r\n  return newObj;\r\n}; \r\n\r\nlet onBind = (objName,obj) => { \r\n  if(isARepeatKey(objName)) return; \r\n  var eligibleForDevTools = isBindDueToDevTools == false; \r\n  if(isBindDueToDevTools) isBindDueToDevTools = false;\r\n  if(!isARepeatKey(objName) && eligibleForDevTools) {\r\n    devTools.send(`${objName}-bound`, removeRepeatsFromState(state.boundObjects))\r\n  } \r\n  return obj;\r\n};\r\n\r\nregisterPlugin({\r\n  name: 'reduxDevToolsConnector',\r\n  postBind: onBind\r\n});"],"names":["devTools","state","simpleBind","getState","useDevTools","window","__REDUX_DEVTOOLS_EXTENSION__","isBindDueToDevTools","connect","latency","subscribe","message","console","log","JSON","stringify","type","let","newState","parse","key","bind","isARepeatKey","name","indexOf","registerPlugin","postBind","objName","obj","eligibleForDevTools","send","boundObjects","Object","keys","reduce","newObj"],"mappings":"iNAEA,IAIIA,2EAHAC,UAAQC,EAAWC,YAEjBC,OAA4D,IAAvCC,OAAOC,6BACpBC,GAAsB,EACjCH,IACDJ,EAAWK,OAAOC,6BAA6BE,QAAQ,CAACC,QAAS,KACxDC,mBAAWC,gEAElB,GADAC,QAAQC,8BAA8BC,KAAKC,UAAUJ,EAAQ,KAAK,IAC7C,aAAjBA,EAAQK,MAAuBL,EAAQV,MAAO,CAChDgB,IAAIC,EAAWJ,KAAKK,MAAMR,EAAQV,OAClC,IAAI,IAAImB,KAAOF,EACbX,GAAsB,EACtBc,EAAKD,EAAIF,EAASE,OAM1BH,IAAIK,WAAeC,UAAoC,GAA5BA,EAAKC,QAAQ,aAoBxCC,EAAe,CACbF,KAAM,yBACNG,kBAZYC,EAAQC,GACpB,IAAGN,EAAaK,GAAhB,CACA,IAV2BC,EAUvBC,EAA6C,GAAvBtB,EAK1B,OAJGA,IAAqBA,GAAsB,IAC1Ce,EAAaK,IAAYE,GAC3B7B,EAAS8B,KAAQH,YAbQC,EAagC3B,EAAM8B,aAZpDC,OAAOC,KAAKL,GAAKM,gBAAQC,EAAOf,GAE3C,OADIE,EAAaF,KAAMe,EAAOf,GAAOQ,EAAIR,IAClCe,GACP,MAWKP"}